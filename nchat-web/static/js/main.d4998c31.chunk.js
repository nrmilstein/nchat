(this["webpackJsonpnchat-web"]=this["webpackJsonpnchat-web"]||[]).push([[0],[,,,,,,,,,,,,function(e,t,a){e.exports={main:"LoadingIcon_main__34XFe",rotateLoadingIcon:"LoadingIcon_rotateLoadingIcon__7vz7G"}},function(e,t,a){e.exports={main:"ConversationCreatorViewBanner_main__2RuqB",status:"ConversationCreatorViewBanner_status__33eIj",label:"ConversationCreatorViewBanner_label__1GUTo",to:"ConversationCreatorViewBanner_to__2CFmT",loading:"ConversationCreatorViewBanner_loading__1Bazp",success:"ConversationCreatorViewBanner_success__4uYs9",error:"ConversationCreatorViewBanner_error__3xyF-",input:"ConversationCreatorViewBanner_input__1n_BT",logoCompact:"ConversationCreatorViewBanner_logoCompact__xXF5g",logo:"ConversationCreatorViewBanner_logo__3JRhd"}},function(e,t,a){e.exports={main:"ContentView_main__1wKd8",noConversationContainer:"ContentView_noConversationContainer__cNJRp",noConversation:"ContentView_noConversation__2Aa6q",logo:"ContentView_logo__145Qh",logoFull:"ContentView_logoFull__1bV84",hint:"ContentView_hint__2LgK_",newChatIcon:"ContentView_newChatIcon__3nwJn",logoCompact:"ContentView_logoCompact__2wA-P"}},function(e,t,a){e.exports={main:"ConversationRow_main__15UeD",main_selected:"ConversationRow_main_selected__1NOlm",bubble:"ConversationRow_bubble__3Ao4F",full:"ConversationRow_full__Jdv7t",header:"ConversationRow_header__1ZnpL",name:"ConversationRow_name__23KPO",time:"ConversationRow_time__OgSgH",message:"ConversationRow_message__foiam"}},function(e,t,a){e.exports={main:"AccountsView_main__3bB6D",logoContainer:"AccountsView_logoContainer__WpB20",logo:"AccountsView_logo__3C1wl",intro:"AccountsView_intro__TLRBm",divider:"AccountsView_divider__OB39W",selector:"AccountsView_selector__2zNAb",tryNow:"AccountsView_tryNow__2DSPt",authenticate:"AccountsView_authenticate__3Ry6X"}},function(e,t,a){e.exports={main:"Sidebar_main__4NAoH",control:"Sidebar_control__zeglL",button:"Sidebar_button___Uwje",icon:"Sidebar_icon__2be8Y"}},,,function(e,t,a){e.exports={main:"SidebarBanner_main__aKmsQ",userName:"SidebarBanner_userName__2-u0O",button:"SidebarBanner_button__2yvjF",icon:"SidebarBanner_icon__3ED6o"}},,,,,,,function(e,t,a){e.exports={main:"MessageView_main__iUNFr",messageBody:"MessageView_messageBody__2HVi_",fromUs_synced:"MessageView_fromUs_synced__xva42",fromUs_unsynced:"MessageView_fromUs_unsynced__3hq1Q",fromThem:"MessageView_fromThem__2rvmg"}},function(e,t,a){e.exports={signUpMessage:"LoginForm_signUpMessage__1r2se",status:"LoginForm_status__19Y73",loading:"LoginForm_loading__25Wew",header:"LoginForm_header__2JLXQ"}},function(e,t,a){e.exports={loginMessage:"SignUpForm_loginMessage__37JjP",status:"SignUpForm_status__1IEWG",loading:"SignUpForm_loading__1JIgt",header:"SignUpForm_header__21dfs"}},,,,function(e,t,a){e.exports={main:"ConversationViewBanner_main__1QcAL",name:"ConversationViewBanner_name__6kOJg",logoCompact:"ConversationViewBanner_logoCompact__1ZKm8",logo:"ConversationViewBanner_logo__-7pzv"}},function(e,t,a){e.exports={main:"ChatAppLoader_main__3MLko",loading:"ChatAppLoader_loading__10PNe",loadingIcon:"ChatAppLoader_loadingIcon__1FXvN",errorMessage:"ChatAppLoader_errorMessage__3ZIkB"}},function(e,t,a){e.exports={main:"TryNowForm_main__3uKR4",loading:"TryNowForm_loading__2llzz",header:"TryNowForm_header__zTYsS"}},,function(e,t,a){e.exports={main:"MessagesView_main__42rqi",loading:"MessagesView_loading__1CrH0",loadingIcon:"MessagesView_loadingIcon__6ERDa"}},function(e,t,a){e.exports={main:"MessageInput_main__2csiL",input:"MessageInput_input__2yt7Q",button:"MessageInput_button__1IFqk"}},,,function(e,t,a){e.exports={main:"ConversationCreatorView_main__2pC5Z",spacer:"ConversationCreatorView_spacer__3HChQ"}},,,,,function(e,t,a){e.exports={main:"ConversationList_main__6a_YG"}},function(e,t,a){e.exports={main:"ConversationView_main__N3c4M"}},function(e,t,a){e.exports={main:"ChatApp_main__1mAeE"}},,,,,function(e,t,a){e.exports=a(67)},,,,,,,,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(44),o=a.n(s),i=a(5),c=a(6),u=a(2),l=a(7),d=a(8),h=a(11),m=a(40),v=a(1),p=a.n(v),f=a(50),g=a(4),b=a(70),y=a(24),C=a(39),_=a(18),w=a(26),E=a.n(w),O=a(51),k=a(19),j=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,null,[{key:"fetch",value:function(e){function t(t,a,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(g.a)(p.a.mark((function e(t,a,n){var r,s,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={Accept:"application/json"},a&&(r["X-API-KEY"]=a),n?n.headers?this.appendHeaders(n.headers,r):n.headers=r:n={headers:r},e.next=5,fetch(this.apiUrl+t,n);case 5:return s=e.sent,o=s.clone(),e.next=9,s.json();case 9:if(i=e.sent,s.ok&&(!("status"in i)||"success"===i.status)){e.next=16;break}if(!("status"in i)||!("message"in i)){e.next=15;break}throw new x("Nchat server error: "+i.message,o,i);case 15:throw new S("Nchat server error.",o);case 16:if("status"in i){e.next=18;break}throw new S("Missing 'status' field in nchat response.",o);case 18:return e.abrupt("return",i);case 19:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}())},{key:"get",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fetch(t,a,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a,n,r){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Object(k.a)(Object(k.a)({},r),{},{method:"POST",body:JSON.stringify(a)}),e.abrupt("return",this.fetch(t,n,s));case 2:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a,n,r){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Object(k.a)(Object(k.a)({},r),{},{method:"PUT",body:JSON.stringify(a)}),e.abrupt("return",this.fetch(t,n,s));case 2:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(k.a)(Object(k.a)({},n),{},{method:"DELETE"}),e.abrupt("return",this.fetch(t,a,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"appendHeaders",value:function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e instanceof Headers?e.append(a,t[a]):Array.isArray(e)?e.push([a,t[a]]):"object"===typeof e&&(e[a]=t[a]))}}]),e}();j.apiUrl="/api/v1/";var S=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e,n){var r;return Object(i.a)(this,a),(r=t.call(this,e)).response=void 0,Error.captureStackTrace&&Error.captureStackTrace(Object(u.a)(r),a),r.response=n,r}return a}(Object(O.a)(Error)),x=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e,n,r){var s;return Object(i.a)(this,a),(s=t.call(this,e,n)).body=void 0,Error.captureStackTrace&&Error.captureStackTrace(Object(u.a)(s),a),s.body=r,s}return a}(S),N=j,L=r.a.createContext({authKey:"",user:{id:-1,name:"",username:""}});function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function I(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var M=r.a.createElement("g",{stroke:"#bababa",strokeLinejoin:"round"},r.a.createElement("path",{className:"LogoutIcon__hoverStroke",d:"m23.66 10.666v-5.6004h-19.33v29.869h19.33v-5.6004",fill:"none",strokeLinecap:"round",strokeWidth:5.9988}),r.a.createElement("path",{className:"LogoutIcon__hoverFill",d:"m16.192 17.434h13.998v-5.1316l8.932 7.6974-8.932 7.6974v-5.1316h-13.998z",fill:"#bababa",strokeWidth:.9998})),P=function(e){var t=e.svgRef,a=e.title,n=I(e,["svgRef","title"]);return r.a.createElement("svg",U({width:40,height:40,viewBox:"0 0 40 40",ref:t},n),a?r.a.createElement("title",null,a):null,M)},R=r.a.forwardRef((function(e,t){return r.a.createElement(P,U({svgRef:t},e))}));a.p;function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function V(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var T=r.a.createElement("path",{className:"PlusIcon__hoverStroke",d:"m3 19.737h34m-17-16.737-0.012014 34",fill:"none",stroke:"#bababa",strokeLinecap:"round",strokeWidth:6}),A=function(e){var t=e.svgRef,a=e.title,n=V(e,["svgRef","title"]);return r.a.createElement("svg",B({width:40,height:40,viewBox:"0 0 40 40",ref:t},n),a?r.a.createElement("title",null,a):null,T)},q=r.a.forwardRef((function(e,t){return r.a.createElement(A,B({svgRef:t},e))})),K=(a.p,a(20)),F=a.n(K);var H=function(e){return r.a.createElement(L.Consumer,null,(function(t){var a;return r.a.createElement("header",{className:F.a.main},r.a.createElement("div",{className:F.a.userName},null!==(a=t.user.name)&&void 0!==a?a:t.user.username),r.a.createElement("button",{className:F.a.button,onClick:e.logoutHandler},r.a.createElement(R,{className:F.a.icon,title:"Logout"})),r.a.createElement("button",{className:F.a.button,onClick:e.handleLaunchConversationCreator},r.a.createElement(q,{className:F.a.icon,title:"New conversation"})))}))},D=a(71),W=a(69),z=a(15),J=a.n(z);var $=function(e){var t,a="",n="";if(e.conversation.messages.length>0){var s=e.conversation.messages[e.conversation.messages.length-1];n=s.body;var o=Object(D.a)(new Date,s.sent);a=0===o?Object(W.a)(s.sent,"p"):1===o?"yesterday":o<7?Object(W.a)(s.sent,"cccc"):Object(W.a)(s.sent,"P")}var i=null!==(t=e.conversation.conversationPartner.name)&&void 0!==t?t:e.conversation.conversationPartner.username;return r.a.createElement("div",{className:J.a.main+(e.selected?" "+J.a.main_selected:""),onClick:function(){return e.handleConversationRowClick(e.conversation)}},r.a.createElement("div",{className:J.a.bubble},i.split(" ").slice(0,2).map((function(e){return e.charAt(0).toUpperCase()}))),r.a.createElement("div",{className:J.a.full},r.a.createElement("div",{className:J.a.header},r.a.createElement("div",{className:J.a.name},i),r.a.createElement("div",{className:J.a.time},a)),r.a.createElement("div",{className:J.a.message},n)))},Q=a(46),X=a.n(Q);var Y=function(e){var t=e.conversations.map((function(t){return r.a.createElement($,{key:t.uuid,selected:t.uuid===e.selectedConversationUuid,conversation:t,handleConversationRowClick:e.handleConversationRowClick})}));return r.a.createElement("div",{className:X.a.main},t)},G=a(17),Z=a.n(G);var ee=function(e){return r.a.createElement("nav",{className:Z.a.main},r.a.createElement("div",{className:Z.a.control},r.a.createElement("button",{className:Z.a.button,onClick:e.handleLaunchConversationCreator},r.a.createElement(q,{className:Z.a.icon,title:"New Conversation"}))),r.a.createElement(H,{handleLaunchConversationCreator:e.handleLaunchConversationCreator,logoutHandler:e.logoutHandler}),r.a.createElement(Y,{conversations:e.conversations,selectedConversationUuid:e.selectedConversationUuid,handleConversationRowClick:e.handleConversationRowClick}),r.a.createElement("div",{className:Z.a.control},r.a.createElement("button",{className:Z.a.button,onClick:e.logoutHandler},r.a.createElement(R,{className:Z.a.icon,title:"Logout"}))))};function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ae(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ne=r.a.createElement("g",{transform:"translate(-9.6323e-7 -10.288)"},r.a.createElement("g",{transform:"matrix(1.0981 0 0 1.0981 -11.363 -2.7657)",strokeWidth:.91067},r.a.createElement("g",{transform:"matrix(.70143 0 0 .70143 3.8237 -10.6)",fill:"#66c072",fillRule:"evenodd",strokeWidth:1.2983},r.a.createElement("path",{d:"m22.115 44.874v46.131h-12.814l-2e-7 -58.946h38.443v12.814"}),r.a.createElement("path",{d:"m47.744 44.874h12.814v46.131h-12.814z"})))),re=function(e){var t=e.svgRef,a=e.title,n=ae(e,["svgRef","title"]);return r.a.createElement("svg",te({width:39.48,height:45.402,viewBox:"0 0 39.48 45.402",ref:t},n),a?r.a.createElement("title",null,a):null,ne)},se=r.a.forwardRef((function(e,t){return r.a.createElement(re,te({svgRef:t},e))}));a.p;function oe(){return(oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ie(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ce=r.a.createElement("g",{transform:"matrix(1.0981 0 0 1.0981 -11.363 -2.7657)"},r.a.createElement("g",{transform:"matrix(.70143 0 0 .70143 3.8237 -10.6)",fill:"#66c072",fillRule:"evenodd",strokeWidth:1.2983},r.a.createElement("path",{d:"m22.115 44.874v46.131h-12.814l-2e-7 -58.946h38.443v12.814"}),r.a.createElement("path",{d:"m47.744 44.874h12.814v46.131h-12.814z"})),r.a.createElement("g",{strokeWidth:.24095,"aria-label":"chat"},r.a.createElement("path",{d:"m82.203 29.191h6.4659q-0.36738-3.3799-1.7634-5.8047-1.3961-2.4982-3.6004-4.1147-2.1308-1.6165-4.9964-2.3513-2.7921-0.80824-6.0251-0.80824-4.4821 0-7.862 1.6165-3.3799 1.543-5.6577 4.3351-2.2043 2.7186-3.3064 6.4659-1.1021 3.6738-1.1021 7.9355t1.1021 7.862q1.1756 3.5269 3.3799 6.0986 2.2778 2.5717 5.5842 3.9677 3.3799 1.3961 7.715 1.3961 7.2742 0 11.462-3.8208 4.2616-3.8208 5.2903-10.875h-6.3925q-0.58781 4.4086-3.233 6.8333-2.5717 2.4247-7.2007 2.4247-2.9391 0-5.0699-1.1756-2.1308-1.1756-3.4534-3.086-1.3226-1.9839-1.9839-4.4821-0.58781-2.4982-0.58781-5.1434 0-2.8656 0.58781-5.5107 0.58781-2.7186 1.9104-4.776 1.3961-2.0573 3.6738-3.3064 2.2778-1.2491 5.6577-1.2491 3.9677 0 6.319 1.9839 2.3513 1.9839 3.086 5.5842z"}),r.a.createElement("path",{d:"m95.878 2.5186v52.462h6.2455v-21.455q0-2.5717 0.66129-4.7025 0.73477-2.2043 2.1308-3.8208 1.3961-1.6165 3.4534-2.4982 2.1308-0.88172 4.9964-0.88172 3.6004 0 5.6577 2.0573 2.0573 2.0573 2.0573 5.5842v25.717h6.2455v-24.982q0-3.086-0.66129-5.5842-0.58781-2.5717-2.1308-4.4086t-4.0412-2.8656q-2.4982-1.0287-6.2455-1.0287-1.69 0-3.5269 0.36738-1.7634 0.36738-3.4534 1.1756-1.6165 0.73477-2.9391 1.9839-1.3226 1.1756-2.0574 2.9391h-0.14695v-20.059z"}),r.a.createElement("path",{d:"m170.43 54.834q-1.6165 0.9552-4.4821 0.9552-2.4247 0-3.8943-1.3226-1.3961-1.3961-1.3961-4.4821-2.5717 3.086-6.0251 4.4821-3.3799 1.3226-7.3477 1.3226-2.5717 0-4.9229-0.58781-2.2778-0.58781-3.9677-1.8369t-2.7186-3.233q-0.9552-2.0573-0.9552-4.9229 0-3.233 1.1022-5.2903t2.8656-3.3064q1.8369-1.3226 4.1147-1.9839 2.3512-0.66129 4.776-1.1021 2.5717-0.51434 4.8494-0.73477 2.3512-0.29391 4.1147-0.73477 1.7634-0.51434 2.7921-1.3961 1.0287-0.9552 1.0287-2.7186 0-2.0573-0.80824-3.3064-0.73476-1.2491-1.9839-1.9104-1.1756-0.66129-2.7186-0.88172-1.4695-0.22043-2.9391-0.22043-3.9677 0-6.6129 1.543-2.6452 1.4695-2.8656 5.6577h-6.2455q0.14696-3.5269 1.4695-5.9516 1.3226-2.4247 3.5269-3.8943 2.2043-1.543 4.9964-2.2043 2.8656-0.66129 6.0986-0.66129 2.5717 0 5.0699 0.36738 2.5717 0.36738 4.629 1.543 2.0573 1.1021 3.3064 3.1595 1.2491 2.0573 1.2491 5.3638v19.545q0 2.2043 0.22043 3.233 0.2939 1.0287 1.7634 1.0287 0.80824 0 1.9104-0.36738zm-10.14-19.471q-1.1756 0.88172-3.086 1.3226-1.9104 0.36738-4.0412 0.66129-2.0574 0.22043-4.1882 0.58781-2.1308 0.29391-3.8208 1.0287t-2.7921 2.1308q-1.0287 1.3226-1.0287 3.6738 0 1.543 0.58782 2.6452 0.66129 1.0287 1.6165 1.69 1.0287 0.66129 2.3512 0.9552 1.3226 0.29391 2.7921 0.29391 3.086 0 5.2903-0.80824 2.2043-0.88172 3.6004-2.1308 1.3961-1.3226 2.0574-2.7921 0.66129-1.543 0.66129-2.8656z"}),r.a.createElement("path",{d:"m184.91 16.993v-11.389h-6.2455v11.389h-6.4659v5.5107h6.4659v24.174q0 2.6452 0.51434 4.2616 0.51433 1.6165 1.543 2.4982 1.1022 0.88172 2.7921 1.2491 1.7634 0.29391 4.1882 0.29391h4.776v-5.5107h-2.8656q-1.4695 0-2.4247-0.07348-0.88171-0.14695-1.396-0.51434t-0.73477-1.0287q-0.14695-0.66129-0.14695-1.7634v-23.586h7.5681v-5.5107z"}))),ue=function(e){var t=e.svgRef,a=e.title,n=ie(e,["svgRef","title"]);return r.a.createElement("svg",oe({width:200,height:58.496,viewBox:"0 0 200 58.496",ref:t},n),a?r.a.createElement("title",null,a):null,ce)},le=r.a.forwardRef((function(e,t){return r.a.createElement(ue,oe({svgRef:t},e))})),de=(a.p,a(33)),he=a.n(de);var me=function(e){var t;return r.a.createElement("header",{className:he.a.main},r.a.createElement("div",{className:he.a.name},null!==(t=e.selectedConversation.conversationPartner.name)&&void 0!==t?t:e.selectedConversation.conversationPartner.username),r.a.createElement(se,{className:he.a.logoCompact,title:"nchat logo"}),r.a.createElement(le,{className:he.a.logo,title:"nchat logo"}))},ve=a(27),pe=a.n(ve);var fe=function(e){return r.a.createElement(L.Consumer,null,(function(t){var a;return r.a.createElement("div",{className:pe.a.main+((null===(a=t.user)||void 0===a?void 0:a.id)===e.message.senderId?null===e.message.id?" "+pe.a.fromUs_unsynced:" "+pe.a.fromUs_synced:" "+pe.a.fromThem)},r.a.createElement("div",{className:pe.a.messageBody},e.message.body))}))},ge=a(37),be=a.n(ge),ye=a(12),Ce=a.n(ye),_e=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).SCROLL_TOLERANCE=40,n.conversationViewDiv=r.a.createRef(),n.context=void 0,n.scrollToBottom=n.scrollToBottom.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"getSnapshotBeforeUpdate",value:function(e,t){return{isScrolledToBottom:this.isScrolledToBottom()}}},{key:"componentDidUpdate",value:function(e,t,a){var n,r,s=e.messages,o=this.props.messages;(null===(n=s[s.length-1])||void 0===n?void 0:n.uuid)!==(null===(r=o[o.length-1])||void 0===r?void 0:r.uuid)&&(a.isScrolledToBottom||o[o.length-1].senderId===this.context.user.id)&&this.scrollToBottom()}},{key:"isScrolledToBottom",value:function(){var e=this.conversationViewDiv.current;return null===e||e.scrollTop>=e.scrollHeight-e.clientHeight-this.SCROLL_TOLERANCE}},{key:"scrollToBottom",value:function(){var e=this.conversationViewDiv.current;null!==e&&e.scrollTo(0,e.scrollHeight-e.clientHeight)}},{key:"render",value:function(){var e=this.props.messages.map((function(e){return r.a.createElement(fe,{key:e.uuid,message:e})}));return r.a.createElement("div",{className:be.a.main,ref:this.conversationViewDiv},this.props.isLoading&&r.a.createElement("div",{className:be.a.loading},r.a.createElement("div",{className:be.a.loadingIcon+" "+Ce.a.main})),e)}}]),a}(r.a.Component);_e.contextType=L;var we=_e,Ee=a(38),Oe=a.n(Ee),ke=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={messageBody:""},n.handleChange=n.handleChange.bind(Object(u.a)(n)),n.handleClickSend=n.handleClickSend.bind(Object(u.a)(n)),n.handleKeyDown=n.handleKeyDown.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"handleChange",value:function(e){this.setState({messageBody:e.target.value})}},{key:"handleClickSend",value:function(){var e=Object(g.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.messageBody.trim()){e.next=2;break}return e.abrupt("return");case 2:this.props.handleSendMessage(this.state.messageBody)&&this.setState({messageBody:""});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleKeyDown",value:function(e){"Enter"===e.key&&this.handleClickSend()}},{key:"render",value:function(){return r.a.createElement("div",{className:Oe.a.main},r.a.createElement("input",{name:"messageBody",className:Oe.a.input,type:"text",value:this.state.messageBody,onKeyDown:this.handleKeyDown,onChange:this.handleChange,autoFocus:this.props.autoFocus,placeholder:"Type a message",autoComplete:"off"}),r.a.createElement("button",{className:Oe.a.button+" button",onClick:this.handleClickSend,disabled:this.props.disabled},"Send"))}}]),a}(r.a.Component),je=a(47),Se=a.n(je);var xe=function(e){var t=window.matchMedia("(min-width: 700px)").matches;return r.a.createElement("div",{className:Se.a.main},r.a.createElement(me,{selectedConversation:e.selectedConversation}),r.a.createElement(we,{isLoading:e.selectedConversation.isLoading,messages:e.selectedConversation.messages}),r.a.createElement(ke,{autoFocus:t,handleSendMessage:function(t){return e.handleSendMessage(t),!0}}))};function Ne(){return(Ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Le(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Ue=r.a.createElement("ellipse",{cx:20,cy:20,rx:18,ry:18,strokeWidth:4}),Ie=function(e){var t=e.svgRef,a=e.title,n=Le(e,["svgRef","title"]);return r.a.createElement("svg",Ne({width:40,height:40,viewBox:"0 0 40 40",ref:t},n),a?r.a.createElement("title",null,a):null,r.a.createElement("g",{fill:"none",stroke:"#66c072",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"m10.9 21.485 5.2674 5.2314 12.252-12.169",strokeWidth:4,style:{paintOrder:"normal"}}),Ue))},Me=r.a.forwardRef((function(e,t){return r.a.createElement(Ie,Ne({svgRef:t},e))}));a.p;function Pe(){return(Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Re(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Be,Ve=r.a.createElement("g",{fill:"none"},r.a.createElement("circle",{cx:100,cy:100,r:0,stroke:"#ab2121",strokeWidth:19.413}),r.a.createElement("g",{stroke:"#bc2020",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"m13 13 14 14",strokeWidth:4}),r.a.createElement("path",{d:"m27 13-14 14",strokeWidth:4}),r.a.createElement("ellipse",{cx:20,cy:20,rx:18,ry:18,strokeWidth:4}))),Te=function(e){var t=e.svgRef,a=e.title,n=Re(e,["svgRef","title"]);return r.a.createElement("svg",Pe({width:40,height:40,viewBox:"0 0 40 40",ref:t},n),a?r.a.createElement("title",null,a):null,Ve)},Ae=r.a.forwardRef((function(e,t){return r.a.createElement(Te,Pe({svgRef:t},e))})),qe=(a.p,a(13)),Ke=a.n(qe);!function(e){e[e.Empty=0]="Empty",e[e.Loading=1]="Loading",e[e.Ok=2]="Ok",e[e.Error=3]="Error"}(Be||(Be={}));var Fe=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e;switch(this.props.status.value){case Be.Empty:e=r.a.createElement("span",{className:Ke.a.to},"To:");break;case Be.Loading:e=r.a.createElement("div",{className:Ke.a.loading+" "+Ce.a.main,title:"Checking username..."});break;case Be.Error:e=r.a.createElement(Ae,{className:Ke.a.error,title:this.props.status.message});break;case Be.Ok:e=r.a.createElement(Me,{className:Ke.a.success,title:"Username OK"})}return r.a.createElement("header",{className:Ke.a.main},r.a.createElement("div",{className:Ke.a.status},r.a.createElement("label",{htmlFor:"ConversationCreatorViewBannerInput",className:Ke.a.label},e)),r.a.createElement("input",{id:"ConversationCreatorViewBannerInput",className:Ke.a.input,type:"text",value:this.props.conversationCreatorUsername,autoFocus:!0,onChange:this.props.handleChange,onBlur:this.props.handleBlur,placeholder:"Username",autoComplete:"off"}),r.a.createElement(se,{className:Ke.a.logoCompact,title:"nchat logo"}),r.a.createElement(le,{className:Ke.a.logo,title:"nchat logo"}))}}]),a}(r.a.Component),He=a(41),De=a.n(He),We=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).context=void 0,n.state={username:"",conversationPartner:null,usernameInputStatus:{value:Be.Empty}},n.handleUsernameChange=n.handleUsernameChange.bind(Object(u.a)(n)),n.handleSendMessage=n.handleSendMessage.bind(Object(u.a)(n)),n.handleUsernameInputBlur=n.handleUsernameInputBlur.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"handleUsernameChange",value:function(e){var t=e.target.value;this.setState({usernameInputStatus:{value:Be.Empty},username:t})}},{key:"handleSendMessage",value:function(e){return null!==this.state.conversationPartner&&(this.props.handleCreateConversation(e,this.state.conversationPartner),!0)}},{key:"handleUsernameInputBlur",value:function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({usernameInputStatus:{value:Be.Loading}}),""!==(a=this.state.username.trim())){e.next=7;break}return this.setState({usernameInputStatus:{value:Be.Empty}}),e.abrupt("return");case 7:if(a!==this.context.user.username){e.next=10;break}return this.setState({usernameInputStatus:{value:Be.Error,message:"Cannot send message to self."}}),e.abrupt("return");case 10:return e.prev=10,e.next=13,this.getUser(a);case 13:n=e.sent,this.setState({conversationPartner:n,usernameInputStatus:{value:Be.Ok}}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),this.setState({conversationPartner:null,usernameInputStatus:{value:Be.Error,message:"Username not found."}});case 20:case"end":return e.stop()}}),e,this,[[10,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("users/"+t,this.context.authKey);case 2:return a=e.sent,n=a.data.user,e.abrupt("return",{id:n.id,username:n.username,name:n.name});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:De.a.main},r.a.createElement(Fe,{conversationCreatorUsername:this.state.username,status:this.state.usernameInputStatus,handleChange:this.handleUsernameChange,handleBlur:this.handleUsernameInputBlur}),r.a.createElement("div",{className:De.a.spacer}),r.a.createElement(ke,{autoFocus:!1,handleSendMessage:this.handleSendMessage,disabled:this.state.usernameInputStatus.value!==Be.Ok}))}}]),a}(r.a.Component);We.contextType=L;var ze=We,Je=a(14),$e=a.n(Je);var Qe=function(e){var t;if(e.isConversationCreatorOpen)t=r.a.createElement(ze,{handleCreateConversation:e.handleCreateConversation});else if(null!==e.selectedConversation){var a;t=r.a.createElement(xe,{selectedConversation:e.selectedConversation,handleSendMessage:e.handleSendMessage,key:null===(a=e.selectedConversation)||void 0===a?void 0:a.uuid})}else{var n=window.matchMedia("(hover: hover)").matches?"Click":"Tap";t=r.a.createElement("div",{className:$e.a.noConversationContainer},r.a.createElement("div",{className:$e.a.noConversation},r.a.createElement(se,{className:$e.a.logo+" "+$e.a.logoCompact,title:"nchat logo"}),r.a.createElement(le,{className:$e.a.logo+" "+$e.a.logoFull,title:"nchat logo"}),r.a.createElement("div",{className:$e.a.hint},n,"\xa0",r.a.createElement(q,{className:$e.a.newChatIcon,title:"New conversation"}),"\xa0 to start a new conversation.")))}return r.a.createElement("main",{className:$e.a.main},t)},Xe=a(48),Ye=a.n(Xe),Ge=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={conversations:n.props.conversations,selectedConversationUuid:null,isConversationCreatorOpen:!1},n.handleMessageReceived=n.handleMessageReceived.bind(Object(u.a)(n)),n.handleLaunchConversationCreator=n.handleLaunchConversationCreator.bind(Object(u.a)(n)),n.handleConversationRowClick=n.handleConversationRowClick.bind(Object(u.a)(n)),n.handleCreateConversation=n.handleCreateConversation.bind(Object(u.a)(n)),n.handleSendMessage=n.handleSendMessage.bind(Object(u.a)(n)),n.logoutHandler=n.logoutHandler.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.webSocket.addNotificationListener("newMessage",this.handleMessageReceived)}},{key:"handleLaunchConversationCreator",value:function(){this.setState({selectedConversationUuid:null,isConversationCreatorOpen:!0})}},{key:"handleConversationRowClick",value:function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n,r,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.uuid!==this.state.selectedConversationUuid){e.next=2;break}return e.abrupt("return");case 2:if(this.setState({isConversationCreatorOpen:!1,selectedConversationUuid:t.uuid}),t.isHistoryLoaded||t.isLoading){e.next=14;break}return a=this.state.conversations.findIndex((function(e){return e.uuid===t.uuid})),n=E()(this.state.conversations,Object(_.a)({},a,{isLoading:{$set:!0}})),this.setState({conversations:n}),e.next=9,N.get("conversations/"+t.id,this.props.authKey);case 9:r=e.sent,s=r.data.conversation.messages.map((function(e){return{uuid:Object(b.a)(),id:e.id,senderId:e.senderId,body:e.body,sent:Object(y.a)(e.sent)}})),a=this.state.conversations.findIndex((function(e){return e.uuid===t.uuid})),o=E()(this.state.conversations,Object(_.a)({},a,{messages:{$set:s},isLoading:{$set:!1},isHistoryLoaded:{$set:!0}})),this.setState({conversations:o});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleMessageReceived",value:function(e){var t=e.data.message,a=e.data.conversation,n={uuid:Object(b.a)(),id:t.id,body:t.body,senderId:t.senderId,sent:Object(y.a)(t.sent)},r=this.state.conversations.findIndex((function(e){return e.id===a.id}));if(-1===r){var s=[{uuid:Object(b.a)(),id:a.id,conversationPartner:{id:a.conversationPartner.id,username:a.conversationPartner.username,name:a.conversationPartner.name},messages:[n],isHistoryLoaded:!0,isLoading:!1}].concat(Object(C.a)(this.state.conversations));this.setState({conversations:s})}else{var o=this.addMessageToConversation(this.state.conversations,r,n);this.setState({conversations:o})}}},{key:"handleCreateConversation",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={uuid:Object(b.a)(),id:null,conversationPartner:a,isHistoryLoaded:!0,isLoading:!1,messages:[]},this.setState((function(e,t){return{conversations:[n].concat(Object(C.a)(e.conversations)),selectedConversationUuid:n.uuid,isConversationCreatorOpen:!1}})),this.sendMessage(n.uuid,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleSendMessage",value:function(){var e=Object(g.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.state.selectedConversationUuid){e.next=2;break}return e.abrupt("return");case 2:this.sendMessage(this.state.selectedConversationUuid,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logoutHandler",value:function(){this.props.logoutHandler(),Object(h.c)("/accounts/get-started")}},{key:"addMessageToConversation",value:function(e,t,a){var n=E()(e[t],{messages:{$push:[a]}}),r=E()(e,{$splice:[[t,1]]});return[n].concat(Object(C.a)(r))}},{key:"sendMessage",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a){var n,r=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={uuid:Object(b.a)(),id:null,senderId:this.props.user.id,body:a,sent:new Date},this.setState((function(e,a){var s=r.findConversationIndex(t,e.conversations);return{conversations:r.addMessageToConversation(e.conversations,s,n)}}),Object(g.a)(p.a.mark((function e(){var s,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(s=r.findConversation(t))){e.next=3;break}return e.abrupt("return");case 3:return o={type:"request",method:"sendMessage",data:{username:s.conversationPartner.username,body:a}},e.next=6,r.props.webSocket.sendRequest(o);case 6:i=e.sent,r.setState((function(e,a){var s=r.findConversationIndex(t,e.conversations),o=e.conversations[s].messages.findIndex((function(e){return e.uuid===n.uuid}));return{conversations:E()(e.conversations,Object(_.a)({},s,{id:{$set:i.data.conversation.id},messages:Object(_.a)({},o,{id:{$set:i.data.message.id},sent:{$set:Object(y.a)(i.data.message.sent)}})}))}}));case 8:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"findConversationIndex",value:function(e,t){var a=t||this.state.conversations;return null===e?-1:a.findIndex((function(t){return t.uuid===e}))}},{key:"findConversation",value:function(e,t){var a,n=t||this.state.conversations;return null===e?null:null!==(a=n.find((function(t){return t.uuid===e})))&&void 0!==a?a:null}},{key:"render",value:function(){var e={authKey:this.props.authKey,user:this.props.user},t=this.findConversation(this.state.selectedConversationUuid);return r.a.createElement("div",{className:Ye.a.main},r.a.createElement(L.Provider,{value:e},r.a.createElement(ee,{conversations:this.state.conversations,selectedConversationUuid:this.state.selectedConversationUuid,handleConversationRowClick:this.handleConversationRowClick,handleLaunchConversationCreator:this.handleLaunchConversationCreator,logoutHandler:this.logoutHandler}),r.a.createElement(Qe,{isConversationCreatorOpen:this.state.isConversationCreatorOpen,handleCreateConversation:this.handleCreateConversation,handleSendMessage:this.handleSendMessage,selectedConversation:t})))}},{key:"componentWillUnmount",value:function(){this.props.webSocket.close()}}]),a}(r.a.Component),Ze=a(49),et=function(){function e(t){Object(i.a)(this,e),this.webSocket=void 0,this.isAuthMessageSent=!1,this.requestId=0,this.requestPromiseCallbacks=[],this.notificationListeners={},this.handleMessageReceived=this.handleMessageReceived.bind(this),this.webSocket=t,this.webSocket.addEventListener("message",this.handleMessageReceived)}return Object(c.a)(e,null,[{key:"getWebsocketUrl",value:function(){var e=window.location,t="https:"===e.protocol?"wss:":"ws:";return t+="//"+e.host+"/api/v1/chat"}},{key:"createWebSocket",value:function(){var t=new WebSocket(this.websocketUrl,"nchat");return new Promise((function(a,n){t.addEventListener("open",(function(n){var r=new e(t);a(r)})),t.addEventListener("error",(function(e){n(e)}))}))}}]),Object(c.a)(e,[{key:"handleMessageReceived",value:function(e){var t=JSON.parse(e.data);if("response"===t.type){var a=this.requestPromiseCallbacks[t.id];if("undefined"===typeof a)return;"success"===t.status?a.resolve(t):a.reject(t)}else if("notification"===t.type){var n=this.notificationListeners[t.method];if("undefined"===typeof n)return;var r,s=Object(Ze.a)(n);try{for(s.s();!(r=s.n()).done;){(0,r.value)(t)}}catch(o){s.e(o)}finally{s.f()}}}},{key:"addNotificationListener",value:function(e,t){var a;this.notificationListeners.hasOwnProperty(e)?null===(a=this.notificationListeners[e])||void 0===a||a.push(t):this.notificationListeners[e]=[t]}},{key:"sendRequest",value:function(e){var t=this,a=this.getNextId();return e.id=a,this.webSocket.send(JSON.stringify(e)),new Promise((function(e,n){t.registerPromise(a,e,n)}))}},{key:"close",value:function(){this.webSocket.close()}},{key:"registerPromise",value:function(e,t,a){this.requestPromiseCallbacks[e]={resolve:t,reject:a}}},{key:"getNextId",value:function(){return this.requestId++}}]),e}();et.websocketUrl=et.getWebsocketUrl();var tt,at=et,nt=a(34),rt=a.n(nt),st=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={user:e.props.user,conversations:null,webSocket:null,errorMessage:null},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(p.a.mark((function e(){var t,a,n,r,s,o,i,c,u,l=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.props.authKey){e.next=3;break}return setTimeout((function(){return Object(h.c)("/accounts/get-started")}),1),e.abrupt("return");case 3:return t=this.props.authKey,e.prev=4,a=null===this.state.user?this.initUser(t):Promise.resolve(this.state.user),n=this.initConversations(t),r=at.createWebSocket().then((function(e){return l.sendAuth(t,e),e})),e.next=10,Promise.all([a,n,r]);case 10:s=e.sent,o=Object(f.a)(s,3),i=o[0],c=o[1],u=o[2],this.setState({user:i,conversations:c,webSocket:u}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),e.t0 instanceof S&&403===e.t0.response.status?this.props.logoutHandler():this.setState({errorMessage:"Could not load nchat. Please try again later."});case 21:case"end":return e.stop()}}),e,this,[[4,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"initUser",value:function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("authenticate",t);case 2:return a=e.sent,n={id:a.data.user.id,name:a.data.user.name,username:a.data.user.username},e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"initConversations",value:function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("conversations",t);case 2:return a=e.sent,n=a.data.conversations.map((function(e){return{uuid:Object(b.a)(),id:e.id,conversationPartner:{id:e.conversationPartner.id,username:e.conversationPartner.username,name:e.conversationPartner.name},messages:e.messages.map((function(e){return{uuid:Object(b.a)(),id:e.id,senderId:e.senderId,body:e.body,sent:Object(y.a)(e.sent)}})),isHistoryLoaded:!1,isLoading:!1}})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendAuth",value:function(e,t){var a={type:"request",method:"authorize",data:{authKey:e}};return t.sendRequest(a)}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:rt.a.main},this.state.user&&this.state.conversations&&this.state.webSocket&&this.props.authKey?r.a.createElement(Ge,{authKey:this.props.authKey,user:this.state.user,webSocket:this.state.webSocket,conversations:this.state.conversations,logoutHandler:this.props.logoutHandler}):r.a.createElement("div",{className:rt.a.loading},null===this.state.errorMessage?r.a.createElement("div",{className:rt.a.loadingIcon+" "+Ce.a.main}):r.a.createElement("div",{className:rt.a.errorMessage},this.state.errorMessage)))}}]),a}(r.a.Component),ot=a(28),it=a.n(ot);!function(e){e[e.Empty=0]="Empty",e[e.Loading=1]="Loading",e[e.Error=2]="Error"}(tt||(tt={}));var ct,ut=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={username:"",password:"",status:{value:tt.Empty}},n.handleChange=n.handleChange.bind(Object(u.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"handleChange",value:function(e){switch(e.target.name){case"username":this.setState({username:e.target.value});break;case"password":this.setState({password:e.target.value})}}},{key:"handleSubmit",value:function(){var e=Object(g.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({status:{value:tt.Loading}}),e.prev=2,e.next=5,this.props.authenticateUser(this.state.username,this.state.password);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),e.t0 instanceof x&&1===e.t0.body.code?this.setState({status:{value:tt.Error,message:"The username or password you entered doesn't match our records. Please try again."}}):this.setState({status:{value:tt.Error,message:"Could not login. Please try again later."}});case 10:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=window.matchMedia("(min-width: 700px)").matches;switch(this.state.status.value){case tt.Empty:e=null;break;case tt.Loading:e=r.a.createElement("div",{className:it.a.loading+" "+Ce.a.main});break;case tt.Error:e=r.a.createElement("div",{className:"errorMessage"},this.state.status.message)}return r.a.createElement("div",{className:it.a.main},r.a.createElement("h1",{className:it.a.header},"Login"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("p",null,r.a.createElement("input",{className:"textInput",name:"username",type:"text",placeholder:"Username",value:this.state.username,onChange:this.handleChange,required:!0,autoFocus:t})),r.a.createElement("p",null,r.a.createElement("input",{className:"textInput",name:"password",type:"password",placeholder:"Password",value:this.state.password,onChange:this.handleChange,required:!0})),r.a.createElement("p",null,r.a.createElement("input",{className:"button",type:"submit",value:"Login"}))),r.a.createElement("div",{className:it.a.signUpMessage},"Don't have an account? ",r.a.createElement(h.a,{to:"../get-started"},"Sign up")),r.a.createElement("div",{className:it.a.status},e))}}]),a}(r.a.Component),lt=a(35),dt=a.n(lt);!function(e){e[e.Empty=0]="Empty",e[e.Loading=1]="Loading",e[e.Error=2]="Error"}(ct||(ct={}));var ht,mt=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={status:{value:ct.Empty}},n.handleClick=n.handleClick.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"handleClick",value:function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:{value:ct.Loading}}),e.prev=1,e.next=4,N.post("demoUsers",{});case 4:a=e.sent,n=a.data.authKey,r={id:a.data.user.id,username:a.data.user.username,name:a.data.user.name},this.props.setAuthenticatedUser(n,r),Object(h.c)("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({status:{value:ct.Error,message:"Could not launch demo. Please try again later."}});case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e;switch(this.state.status.value){case ct.Empty:e=null;break;case ct.Loading:e=r.a.createElement("div",{className:dt.a.loading+" "+Ce.a.main});break;case ct.Error:e=r.a.createElement("div",{className:"errorMessage"},this.state.status.message)}return r.a.createElement("div",{className:dt.a.main},r.a.createElement("h1",{className:dt.a.header},"Try now!"),r.a.createElement("p",null,"Try a demo of nchat now."),r.a.createElement("button",{className:"button",onClick:this.handleClick},"Try it now \u2192"),r.a.createElement("div",{className:dt.a.status},r.a.createElement("p",null,e)))}}]),a}(r.a.Component),vt=a(29),pt=a.n(vt);!function(e){e[e.Empty=0]="Empty",e[e.Loading=1]="Loading",e[e.Error=2]="Error"}(ht||(ht={}));var ft=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={name:"",username:"",password:"",status:{value:ht.Empty}},n.handleChange=n.handleChange.bind(Object(u.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"handleChange",value:function(e){switch(e.target.name){case"username":this.setState({username:e.target.value});break;case"password":this.setState({password:e.target.value});break;case"name":this.setState({name:e.target.value})}}},{key:"handleSubmit",value:function(){var e=Object(g.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({status:{value:ht.Loading}}),a={name:this.state.name,username:this.state.username,password:this.state.password},e.prev=3,e.next=6,N.post("users",a);case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),e.t0 instanceof x&&6===e.t0.body.code?this.setState({status:{value:ht.Error,message:"That username is already taken. Please select another username."}}):this.setState({status:{value:ht.Error,message:"Could not sign up. Please try again later."}}),e.abrupt("return");case 12:return e.prev=12,e.next=15,this.props.authenticateUser(this.state.username,this.state.password);case 15:e.next=21;break;case 17:return e.prev=17,e.t1=e.catch(12),this.setState({status:{value:ht.Error,message:"Error logging in: account created but could not login.\n           Please try logging in again later."}}),e.abrupt("return");case 21:case"end":return e.stop()}}),e,this,[[3,8],[12,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=window.matchMedia("(min-width: 700px)").matches;switch(this.state.status.value){case ht.Empty:e=null;break;case ht.Loading:e=r.a.createElement("div",{className:pt.a.loading+" "+Ce.a.main});break;case ht.Error:e=r.a.createElement("div",{className:"errorMessage"},this.state.status.message)}return r.a.createElement("div",{className:pt.a.main},r.a.createElement("h1",{className:pt.a.header},"Sign up"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("p",null,r.a.createElement("input",{className:"textInput",name:"name",type:"text",placeholder:"Display name",value:this.state.name,onChange:this.handleChange,required:!0,autoFocus:t})),r.a.createElement("p",null,r.a.createElement("input",{className:"textInput",name:"username",type:"text",placeholder:"Username",value:this.state.username,onChange:this.handleChange,required:!0})),r.a.createElement("p",null,r.a.createElement("input",{className:"textInput",name:"password",type:"password",placeholder:"Password",value:this.state.password,onChange:this.handleChange,required:!0})),r.a.createElement("p",null,r.a.createElement("input",{className:"button",type:"submit",value:"Sign up"}))),r.a.createElement("div",{className:pt.a.loginMessage},"Already have an account? ",r.a.createElement(h.a,{to:"../login"},"Login")),r.a.createElement("div",{className:pt.a.status},e))}}]),a}(r.a.Component),gt=a(16),bt=a.n(gt),yt=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).authenticateUser=n.authenticateUser.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"authenticateUser",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a){var n,r,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:t,password:a},e.next=3,N.post("authenticate",n);case 3:r=e.sent,s=r.data.authKey,o={id:r.data.user.id,username:r.data.user.username,name:r.data.user.name},this.props.setAuthenticatedUser(s,o),Object(h.c)("/");case 8:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("main",{className:bt.a.main},r.a.createElement("div",{className:bt.a.logoContainer},r.a.createElement(le,{className:bt.a.logo,title:"nchat logo"})),r.a.createElement("div",{className:bt.a.intro},"nchat is an app for chatting with your friends."),r.a.createElement("div",{className:bt.a.selector},r.a.createElement("section",{className:bt.a.tryNow},r.a.createElement(mt,{setAuthenticatedUser:this.props.setAuthenticatedUser})),r.a.createElement("div",{className:bt.a.divider},"or"),r.a.createElement("section",{className:bt.a.authenticate},r.a.createElement(h.b,null,r.a.createElement(ft,{path:"get-started",authenticateUser:this.authenticateUser}),r.a.createElement(ut,{path:"login",authenticateUser:this.authenticateUser})))))}}]),a}(r.a.Component),Ct=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(i.a)(this,a),(n=t.call(this,e)).state={authKey:null,user:null},n.setAuthenticatedUser=n.setAuthenticatedUser.bind(Object(u.a)(n)),n.logout=n.logout.bind(Object(u.a)(n));var r=(new m.a).get("authKey");return r&&(n.state.authKey=r),n}return Object(c.a)(a,[{key:"setAuthenticatedUser",value:function(e,t){(new m.a).set("authKey",e,{path:"/",sameSite:"lax",maxAge:31536e3}),this.setState({authKey:e,user:t})}},{key:"logout",value:function(){(new m.a).remove("authKey",{path:"/"}),this.setState({authKey:null,user:null})}},{key:"render",value:function(){return r.a.createElement(h.b,{className:"Router"},r.a.createElement(st,{path:"/",authKey:this.state.authKey,user:this.state.user,key:this.state.authKey,logoutHandler:this.logout}),r.a.createElement(yt,{path:"accounts/*",setAuthenticatedUser:this.setAuthenticatedUser}))}}]),a}(r.a.Component);a(66);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ct,null)),document.getElementById("root"))}],[[53,1,2]]]);
//# sourceMappingURL=main.d4998c31.chunk.js.map